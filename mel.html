<!DOCTYPE html>
<html lang="pt-BR" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Para a minha princesa</title>
  <style>
    body {
      margin:0; padding:0; background:#2F4F2F; overflow:hidden;
      display:flex; flex-direction: column; align-items:center;
      font-family: 'Poppins', sans-serif;
      color: #9ACD32; /* Verde amarelo claro */
      user-select: none;
      height: 100vh;
    }
    button {
      background: #556B2F;      /* Verde musgo */
      border: none;
      padding: 18px 40px;       /* Maior */
      border-radius: 30px;
      color: #DFF0D8;           /* Verde claro */
      font-weight: 700;
      font-size: 1.3rem;
      cursor: pointer;
      box-shadow: 0 0 15px #556B2F;
      transition: background 0.3s ease;
      margin: 20px 0;
    }
    button:hover {
      background: #3e4b1a;      /* Verde musgo mais escuro no hover */
    }
    canvas {
      display: block;
      background: #2F4F2F; /* Mesma cor do fundo */
    }
  </style>
</head>
<body>
  <button id="btnTransform">CLIQUE AQUI SE VC ME AMA</button>
  <canvas id="canvas"></canvas>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const btn = document.getElementById('btnTransform');

  let W, H;

  function resize() {
    W = window.innerWidth;
    H = window.innerHeight;
    canvas.width = W;
    canvas.height = H;
  }
  resize();
  window.addEventListener('resize', () => {
    resize();
    setupParticles();
  });

  class Particle {
    constructor(x, y) {
      this.baseX = x;
      this.baseY = y;
      this.x = x;
      this.y = y;
      this.radius = 3;
      this.color = "rgba(154,205,50,0.9)"; // Verde amarelo claro (LimeGreen)
      this.destX = x;
      this.destY = y;
      this.speed = 0.12 + Math.random() * 0.05;
      this.active = true;
    }
    update() {
      if (!this.active) return;
      const dx = this.destX - this.x;
      const dy = this.destY - this.y;
      this.x += dx * this.speed;
      this.y += dy * this.speed;
    }
    draw(ctx) {
      if (!this.active) return;
      ctx.beginPath();
      ctx.fillStyle = this.color;
      ctx.shadowColor = this.color;
      ctx.shadowBlur = 8;
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
      ctx.fill();
    }
  }

  const auxCanvas = document.createElement('canvas');
  const auxCtx = auxCanvas.getContext('2d');

  function drawHeartPath(ctx, x, y, size, fill = true) {
    ctx.beginPath();
    const topCurveHeight = size * 0.3;
    ctx.moveTo(x, y + topCurveHeight);
    ctx.bezierCurveTo(
      x, y,
      x - size / 2, y,
      x - size / 2, y + topCurveHeight
    );
    ctx.bezierCurveTo(
      x - size / 2, y + (size + topCurveHeight) / 2,
      x, y + (size + topCurveHeight) / 1.2,
      x, y + size
    );
    ctx.bezierCurveTo(
      x, y + (size + topCurveHeight) / 1.2,
      x + size / 2, y + (size + topCurveHeight) / 2,
      x + size / 2, y + topCurveHeight
    );
    ctx.bezierCurveTo(
      x + size / 2, y,
      x, y,
      x, y + topCurveHeight
    );
    ctx.closePath();
    if(fill){
      ctx.fill();
    } else {
      ctx.stroke();
    }
  }

  let particles = [];

  const particleRadius = 3;
  const particleGap = particleRadius * 2 - 1; 
  const heartSize = 80;
  const heartCount = 5;

  let heartsPositions = [];

  const message = "TE AMO MUITO MO";

  let animationDone = false;

  function setupParticles() {
    particles = [];
    heartsPositions = [];
    auxCanvas.width = W;
    auxCanvas.height = H;

    // 5 corações alinhados horizontalmente, vertical central + 50 px
    const spacingX = W / (heartCount + 1);
    const centerY = H / 2 + 50;

    for(let i=1; i<=heartCount; i++){
      heartsPositions.push({x: spacingX * i, y: centerY});
    }

    let tempParticles = [];

    for(let pos of heartsPositions){
      auxCanvas.width = heartSize;
      auxCanvas.height = heartSize + 40;
      auxCtx.clearRect(0,0,auxCanvas.width, auxCanvas.height);
      auxCtx.fillStyle = 'white';
      drawHeartPath(auxCtx, heartSize / 2, 10, heartSize);

      for(let x=0; x < auxCanvas.width; x += particleGap){
        for(let y=0; y < auxCanvas.height; y += particleGap){
          const pixel = auxCtx.getImageData(x, y, 1, 1).data;
          if(pixel[3] > 128){
            tempParticles.push({
              baseX: pos.x - heartSize/2 + x,
              baseY: pos.y - heartSize/2 + y,
            });
          }
        }
      }
    }

    particles = tempParticles.map(p => new Particle(p.baseX, p.baseY));

    auxCanvas.width = W;
    auxCanvas.height = H;
  }

  function generateTextPoints(text, yOffset) {
    auxCtx.clearRect(0, 0, auxCanvas.width, auxCanvas.height);
    auxCtx.fillStyle = 'white';
    auxCtx.font = `80px 'Poppins', sans-serif`;
    auxCtx.textBaseline = 'middle';
    auxCtx.textAlign = 'center';
    auxCtx.fillText(text, W / 2, H / 2 + yOffset);

    const textPoints = [];
    for(let x=0; x < W; x += particleGap){
      for(let y=0; y < H; y += particleGap){
        const pixel = auxCtx.getImageData(x, y, 1, 1).data;
        if(pixel[3] > 128){
          textPoints.push({x, y});
        }
      }
    }
    return textPoints;
  }

  btn.addEventListener('click', () => {
    if(animationDone) return;
    animationDone = true;
    const points = generateTextPoints(message, 0);

    for(let i=0; i < particles.length; i++){
      if(i < points.length){
        particles[i].active = true;
        particles[i].destX = points[i].x;
        particles[i].destY = points[i].y;
      } else {
        particles[i].active = false;
      }
    }
  });

  function animate() {
    ctx.clearRect(0, 0, W, H);
    particles.forEach(p => {
      p.update();
      p.draw(ctx);
    });
    requestAnimationFrame(animate);
  }

  setupParticles();
  animate();

</script>

</body>
</html>
